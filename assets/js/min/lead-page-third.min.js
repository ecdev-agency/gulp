"use strict";jQuery(document).ready(function(d){var t="",n=[],a=d("form.leadForm").find("#zip");function e(){991<window.innerWidth&&d(".leadForm__range").each(function(e){var a=d(this),t=a.attr("data-min"),n=a.attr("data-max"),r=F(a.attr("value")),o=a.attr("data-symbol"),s=(a.parents(".leadForm__group").hasClass("leadForm__group-percentage")?1:0)?.01:1;a.val();a.inputSliderRange({min:parseInt(t),max:parseInt(n),start:parseInt(r),step:s,grid:1,gridCompression:1,gridSuffix:o,gridCompressionValues:{"-9999999":{text:"",compression:0,digits:0},1e3:{text:"K+",compression:3,digits:0},1e6:{text:"M+",value:3,compression:0,digits:1},1e9:{text:"B+",compression:9,digits:1}},onChanged:function(e){var t;e.hasOwnProperty("detail")&&(t=e.detail.current,parseInt(a.attr("data-max")),e=t,F(a.parents(".leadForm__group").find(".money").val()),(a.parents(".leadForm__group").hasClass("leadForm__group-percentage")?a.parents(".leadForm__group").find(".rangeTarget:not(.money)").val(e):a.parents(".leadForm__group").find(".money").val(t)).trigger("keyup","slider_change"),d(document).off("set_slider_value_by_input"))}}),a.inputSliderRange("setTo",r)})}function r(e){var a=[],t=d(e);t.css("min-height","1px"),t.each(function(e){var t=d(this).outerHeight(!0);a.push(t)});e=Math.max.apply(Math,a);t.css("min-height",e+"px")}function l(e){return e=parseFloat(F(e.toString())),isNaN(e)?"":"$"+(e="number"!=typeof e?parseFloat(e):e).toLocaleString("en-US")}f(!0),d(".phone-mask").mask("(999) 999-9999",{showMaskOnFocus:!0,showMaskOnHover:!1,autoUnmask:!0,clearMaskOnLostFocus:!0}),e(),sm_get_user_geolocation(),d(window).on("resize",function(){e()}),d(window).on("orientationchange",function(){e()},!1);var o=d("#leadForm"),s=d("#stepDotsWrap"),i=(d(".leadForm__btn"),d(".leadForm__step")),p=d(".stepDots__item"),c=(d(".leadForm__navBtn-back"),d(".leadForm__navBtn-next"));function u(e,t,a){if(d(".leadForm__step-active").find(".leadForm__errorText").remove(),d(".leadForm__step-active").find(".validateInput").removeClass("error success"),1==a&&d(".leadForm__step-active").find(".validateInput").each(function(e,t){!function(t){var e=t.attr("type"),a="This is required field",n=t.attr("data-validate"),r=t.val();t.parents(".leadForm__step").find(".stepBtn");switch(e){case"email":a="Please enter a valid email";break;case"tel":a="Please enter valid phone number";break;case"number":var o=F(t.val()),s=F(t.attr("data-min")),i=F(t.attr("data-max"));a=o<s?"This value must be min "+l(parseInt(s)):i<o?"This value must be max "+l(parseInt(i)):"This value is not a number";break;case"text":if("number"==n){s=F(t.val()),o=F(t.attr("data-min")),i=F(t.attr("data-max"));a=s<o?"This value must be min "+l(parseInt(o)):i<s?"This value must be max "+l(parseInt(i)):"This value is not a number";break}if("zip"==n){null!=t.attr("data-user-change")&&"true"==t.attr("data-user-change")&&(d.ajaxSetup({async:!1}),function(e,t){return d.post(sm_obj.ajaxurl,{action:"sm_zip_code_exist",zip:e},function(e){f(!1),e&&e.hasOwnProperty("zip_code")?t.addClass("success").removeClass("error"):t.addClass("error").removeClass("success")})}(r,t).done(function(e){null!=e&&e.hasOwnProperty("zip_code")||(a="This zip code does not exist (only "+geolocation_vars.location_config.available_states.join(", ")+")",t[0].setCustomValidity(a))}));break}}t.parent().find(".leadForm__errorText").remove(),t.removeClass("error success"),t.is(":invalid")||n&&"number"===n&&!function(e){var t=F(e.val()),a=F(e.attr("data-min")),e=F(e.attr("data-max"));if(t<a||e<t)return!1;return!0}(t)||n&&"fullName"===n&&!function(e){return!!/^[a-zA-Z ]+$/.test(e)}(r)?(t[0].setCustomValidity(""),t.addClass("error"),t.focus(),d("<span class='leadForm__errorText'>"+a+"</span>").insertAfter(t)):t.addClass("success")}(d(this))}),0!=d(".leadForm__step-active").find(".leadForm__errorText").length||0!=d(".leadForm__step-active").find(".leadForm__input-error").length)return!1;!function(e,t){var a=d(".leadForm__step-active");"#welcome"!=e?d(".reviewsWrap").hide():d(".reviewsWrap").show();if("#form-preview-step"==e||a.hasClass("editable"))return m(e,t),m("#"+a.attr("id"),t),jQuery.compare(n,o.serializeArray())?(d(".leadForm__step").removeClass("leadForm__step-active"),d("#form-preview-step").addClass("leadForm__step-active")):(o.find("[data-selected-form-options]").html(""),o.addClass("submit"),n=o.serializeArray(),setTimeout(function(){d.post(sm_obj.ajaxurl,{action:"sm_preview_lead_form",data:n},function(e){e.hasOwnProperty("html")&&(m("#form-preview-step","next"),d("#stepDotsWrap").hide(),d("#form-preview-step [data-selected-form-options]").html(e.html),sm_tooltip()),o.removeClass("submit"),clearInterval(d(this))})},100));m(e,t)}(e,t)}function m(e,t){var a,n,r;null!=d(e)&&0<d(e).length&&(a=d(".leadForm__step-active"),n="#user-name-step",i.not(e).removeClass("leadForm__step-active"),d(e).addClass("leadForm__step-active"),d(e).find(".money, .leadForm__input-percentage").trigger("keyup","not_self"),p.removeClass("stepDots__item-active"),r=a.attr("id"),d('.stepDots-active [data-step="#'+r+'"]').addClass("stepDots__item-done").removeClass("stepDots__item-active"),d('.stepDots-active [data-step="'+e+'"]').addClass("stepDots__item-active"),e===n&&"next"===t&&d(n).attr("data-prev-step","#"+a.attr("id")),d(e).hasClass("editable")?s.hide():(a.addClass("leadForm__step-done"),"#welcome"===e?s.hide():s.show()),d(e).next().hasClass("leadForm__step-done")?c.removeClass("leadForm__navBtn-disabled"):c.addClass("leadForm__navBtn-disabled"),window.innerWidth<=820&&d(window).scrollTop(0))}function _(e,t,a){return u(e,1<arguments.length&&void 0!==t?t:"next",2<arguments.length&&void 0!==a&&a)}function v(e,t,a){var n=e.val(),r=[8,9,27,35,36,37,38,39,46,110,188],o=parseFloat(e.attr("max")),s="",n=n.toString().match(/^\d+\.?\d{0,2}/);r.some(function(e){return e===t.keyCode})||o<n&&(n=n.toString().slice(0,-1)),(n="change"==t.type?parseFloat(n).toFixed(2):n)&&(r.some(function(e){return e===t.keyCode})||(s="%"),e.val((n=100<n?100:n)+s),1==a&&e[0].setSelectionRange(e.val().length-1,e.val().length))}function h(e,t){var a,n,r=e.val();""!==r&&(a=r.length,n=e.prop("selectionStart"),r=r.toString().replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,","),e.val(r="$"+r),1==t&&e[0].setSelectionRange(n=r.length-a+n,n),jQuery(document).trigger("input-value-formatted-end"))}function f(e){var t=d("input.checkZip"),a=t.parents(".leadForm__inputWrap"),n=t.parents("label").find("span");1==e?a.addClass("loading"):(a.removeClass("loading"),t.prop("disabled",!1),t.removeClass("leadForm__input-loading"),n.addClass("active"))}function g(e){e.hasOwnProperty("zip_code")&&(d(document).off("geolocation_received"),t=e.zip_code,a.val(t).trigger("change"),f(!1),a.removeClass("error").addClass("success"),e=e,o.append('<input type="hidden" readonly="true" name="city" value="'+e.city+'">'),o.append('<input type="hidden" readonly="true" name="county" value="'+e.county_name+'">'),o.append('<input type="hidden" readonly="true" name="state" value="'+e.state+'">'),o.append('<input type="hidden" readonly="true" name="country" value="'+e.country+'">'))}function F(e){e=parseFloat(e.replace(/[^-0123456789.]/g,""));return e=isNaN(e)?0:e}d(document.body).on("click",".stepDots__item",function(e){var t=d(this);d(".leadForm__step-active .leadForm__input-error").length;(t.hasClass("stepDots__item-active")||t.hasClass("stepDots__item-done"))&&0!=_(t.attr("data-step"),"next",!0)&&t.addClass("stepDots__item-active")}),o.trigger("reset"),d(document.body).on("click change",".stepBtn",function(e){var t=d(this),a=t.attr("data-next-step"),n=d(a),r=d(".leadForm__step-active"),o=t.attr("data-loan-type");r.find(".leadForm__input").trigger("change"),o&&(r.attr("data-next-step",a),d(".stepDots").removeClass("stepDots-active"),d('.stepDots[data-loan-type="'+o+'"]').addClass("stepDots-active"),d(".leadForm__loanCol").removeClass("leadForm__loanCol-active"),t.parents(".leadForm__loanCol").addClass("leadForm__loanCol-active")),0<n.length&&0===r.find(".leadForm__input-error").length&&(r.find(".leadForm__btn").removeClass("leadForm__btn-active"),t.hasClass("leadForm__btn")&&t.toggleClass("leadForm__btn-active"),n.find(".leadForm__input:not([type=tel])").prop("required",!0),setTimeout(function(){_(a,"next",!0)},500))}),jQuery.extend({compare:function(e,t){if(e.length!=t.length)return!1;var a=jQuery.extend(!0,[],e),n=jQuery.extend(!0,[],t);a.sort(),n.sort();for(var r=0,o=a.length;r<o;r++)if(a[r].value!==n[r].value)return!1;return!0}}),d(document).on("click",".editable-header .btn-back",function(){_("#form-preview-step","next",!0)}),d(document.body).on("click",".leadForm__navBtn",function(e){e.preventDefault();var t=d(this),a=d(".leadForm__step-active"),n=a.find(".leadForm__input-error").length,e=a.attr("data-prev-step"),t=t.attr("data-slide");(e="next"===t&&a.next().hasClass("leadForm__step-done")?a.attr("data-next-step"):e)&&0===n&&_(e,t,!0)}),d(".percentageVal").bind("keyup",function(e){return 9!==e.keyCode&&(v(d(this),e,!0),void(d(this).hasClass("leadForm__input-percentage")&&(t=F(d(this).val()),e=F(d(this).parents(".leadForm__step").prev().find(".money").val()),t=parseFloat(e/100*t).toFixed(0),d(this).parents(".leadForm__group").find(".field-group").not(d(this)).val(t).trigger("keyup","not_self"))));var t}),d(document).on("keypress","input.percentageVal",function(e){e=e.which||e.keyCode;if(String.fromCharCode(e).match(/[^0-9.]/g))return!1}),d(document).on("update","input.percentageVal",function(e,t){"not_self"==t&&v(d(this),e,!1)}),d(document).on("click","[data-editable]",function(e){e.preventDefault();e=void 0!==d(this).attr("data-step-target")&&null!=d(this).attr("data-step-target")&&d(this).attr("data-step-target");e?d.when(function(e,t){var a=1<arguments.length&&void 0!==t?t:"next",t=d(e);d(window).scrollTop(0),d(".leadForm__step").removeClass("editable").find(".editable-header").remove(),t.addClass("editable"),t.prepend('<div class="editable-header"><button class="btn-back" type="button">Back to Results</button></div>'),d.when(m(e,a)).then(function(){})}(e,"next",!1)).then(function(){}):alert("Parent fields of this step not found!")}),d(".onlyNumbers").bind("change keyup input click",function(e){this.value.match(/[^0-9+]/g)&&(this.value=this.value.replace(/[^0-9+]/g,""))}),d(document).on("keypress",".checkZip",function(e){d(this).attr("data-user-change",!0)}),d(document).on("geolocation_received",function(e,t){g(t)}),0==sm_user_geo_loading&&(f(!0),getCookie("geolocation")&&g(sm_get_user_geolocation())),d(document).on("input change focusout",".validateInput",function(e){d(this);d(".leadForm__step-active").find(".leadForm__errorText").remove(),d(".leadForm__step-active").find(".validateInput").removeClass("error success")}),d(document).on("input change click","input[name=loan_type]",function(e){var t=d(this);d('input[name="loan_type"]').prop("checked",!1),t.prop("checked",!0)}),d(document).on("input change click","[data-loan-type]",function(e){var t=d(this).attr("data-loan-type");d('input[value="'+t+'"]').prop("checked",!0)}),o.on("submit",function(e){e.preventDefault(),d(window).scrollTop(0),o.addClass("submit");var t=d(this).serializeArray();setTimeout(function(){d.post(sm_obj.ajaxurl,{action:"sm_create_new_lead",data:t},function(e){e.hasOwnProperty("success")&&1==e.success?d(".leadPage").html(e.success_tpl):alert("Error submit form! Please contact administrator."),o.removeClass("submit")})},400)}),o.find("input.percentageVal, input.checkZip").on("click",function(e){d(this).select()}),d(document).on("keypress","input.currency, input.percentageVal",function(e,t){e=e.which||e.keyCode;if(String.fromCharCode(e).match(/[^0-9]/g))return!1}),d(document).on("keyup","input.currency",function(e,t){var a=void 0===t||null==t?"self":t;if(9===e.keyCode)return!1;var n=d(this),r=F(e.target.value),o=n.parents(".leadForm__group").find(".InputSliderRange-Input"),s=(n.attr("data-validate"),parseFloat(n.attr("data-min"))),i=parseFloat(n.attr("data-max-range")),l=parseFloat(n.attr("data-max"));d(this).hasClass("percent-formatting")?v(n,e,!0):h(n,"self"==t);parseFloat(e.target.value);e=n.parents(".leadForm__group").hasClass("leadForm__group-percentage");e&&(n=F(n.parents(".leadForm__step").prev().find(".money").val()),r=100<(n=F(F(parseFloat(100*r/n).toFixed(2).toString()).toString().match(/^\d+\.?\d{0,2}/)+"%"))?l:n),e&&(d(this).hasClass("leadForm__group-percentage")||"not_self"==(e="self"==a?"not_self":"")&&d(this).parents(".leadForm__group").find(".leadForm__input-percentage").val(r).trigger("update",e)),"slider_change"!=a&&(r<s?o.inputSliderRange("setTo",0,!1,!1):i<r?o.inputSliderRange("setTo",i,!1,!1):o.inputSliderRange("setTo",r,!1,!1))}),d(".currency").bind("click",function(e){d(this).select()}),o.bind("keypress keyup keypress keydown",function(e){if(13===e.keyCode||13===e.which)return e.preventDefault(),!1});var y=d("#reviewsSlider");y.slick({slidesToShow:1,slidesToScroll:1,dots:!1,arrows:!0,prevArrow:'<button type="button" class="slick-prev"></button>',nextArrow:'<button type="button" class="slick-next"></button>',responsive:[{breakpoint:820,settings:{slidesToShow:1,centerMode:!1,slidesToScroll:1,arrows:!0,adaptiveHeight:!0,dots:!1}}]}),820<window.innerWidth&&(y.on("afterChange",function(e,t,a,n){r(".reviews__text")}),r(".reviews__text"))});
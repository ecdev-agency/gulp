"use strict";jQuery(document).ready(function(u){var c,a,m,r=u("form.leadForm").find("#zip"),n=u("#leadForm"),s=u("#stepDotsWrap"),o=(u(".leadForm__btn"),u(".leadForm__step")),i=u(".stepDots__item"),l=(u(".leadForm__navBtn-back"),u(".leadForm__navBtn-next"));function d(e){var a=[],t=u(e);t.css("min-height","1px"),t.each(function(e){var t=u(this).outerHeight(!0);a.push(t)});e=Math.max.apply(Math,a);t.css("min-height",e+"px")}function _(e){return e=parseFloat(e),isNaN(e)?"":(e="number"!=typeof e?parseFloat(e):e).toLocaleString("en-US")}function p(e,t,a){u(".leadForm__step-active").find(".leadForm__errorText").remove(),u(".leadForm__step-active").find(".validateInput").removeClass("leadForm__input-error leadForm__input-success"),1==a&&u(".leadForm__step-active").find(".validateInput").each(function(e,t){!function(t){var e=t.attr("type"),a="This is required field",r=t.attr("data-validate"),n=t.val();t.parents(".leadForm__step").find(".stepBtn");switch(e){case"email":a="Please enter a valid email";break;case"tel":a="Please enter valid phone number";break;case"number":var s=f(t.val()),o=f(t.attr("data-min")),i=f(t.attr("data-max"));a=s<o?"This value must be min "+_(parseInt(o)):i<s?"This value must be max "+_(parseInt(i)):"This value is not a number";break;case"text":if("number"==r){o=f(t.val()),s=f(t.attr("data-min")),i=f(t.attr("data-max"));a=o<s?"This value must be min "+_(parseInt(s)):i<o?"This value must be max "+_(parseInt(i)):"This value is not a number";break}if("zip"==r){null!=t.attr("data-user-change")&&"true"==t.attr("data-user-change")&&(u.ajaxSetup({async:!1}),function(e,t){return u.post(sm_obj.ajaxurl,{action:"sm_zip_code_exist",zip:e},function(e){h(!1),e&&e.hasOwnProperty("zip_code")?t.addClass("leadForm__input-success").removeClass("leadForm__input-error "):t.addClass("leadForm__input-error").removeClass("leadForm__input-success ")})}(n,t).done(function(e){null!=e&&e.hasOwnProperty("zip_code")||(a="This zip code does not exist (only "+geolocation_vars.location_config.available_states.join(", ")+")",t[0].setCustomValidity(a))}));break}}t.parent().find(".leadForm__errorText").remove(),t.removeClass("leadForm__input-error leadForm__input-success"),t.is(":invalid")||r&&"number"===r&&!function(e){var t=f(e.val()),a=f(e.attr("data-min")),e=f(e.attr("data-max"));if(t<a||e<t)return!1;return!0}(t)||r&&"fullName"===r&&!function(e){return!!/^[a-zA-Z ]+$/.test(e)}(n)?(t[0].setCustomValidity(""),t.addClass("leadForm__input-error"),t.focus(),u("<span class='leadForm__errorText'>"+a+"</span>").insertAfter(t)):t.addClass("leadForm__input-success")}(u(this))}),0==u(".leadForm__step-active").find(".leadForm__errorText").length&&0==u(".leadForm__step-active").find(".leadForm__input-error").length&&function(e,t){{var a,r,n;0<u(e).length&&(a=u(".leadForm__step-active"),r="#user-name-step",i.removeClass("stepDots__item-active"),a.addClass("leadForm__step-done"),o.not(e).removeClass("leadForm__step-active"),u(e).addClass("leadForm__step-active"),u(e).find(".money, .leadForm__input-percentage").trigger("keyup"),n=a.attr("id"),u('.stepDots-active [data-step="#'+n+'"]').addClass("stepDots__item-done").removeClass("stepDots__item-active"),u('.stepDots-active [data-step="'+e+'"]').addClass("stepDots__item-active"),e===r&&"next"===t&&u(r).attr("data-prev-step","#"+a.attr("id")),"#welcome"===e?s.hide():s.show(),u(e).next().hasClass("leadForm__step-done")?l.removeClass("leadForm__navBtn-disabled"):l.addClass("leadForm__navBtn-disabled"),window.innerWidth<=820&&u(window).scrollTop(0))}}(e,t)}function v(e,t,a){p(e,1<arguments.length&&void 0!==t?t:"next",2<arguments.length&&void 0!==a&&a)}function g(e){return e.toString().match(/^\d+\.?\d{0,2}/)}function h(e){var t=u("input.checkZip"),a=t.parents(".leadForm__inputWrap");1==e?a.addClass("loading"):(a.removeClass("loading"),t.prop("disabled",!1),t.removeClass("leadForm__input-loading"),t.attr("placeholder",t.attr("data-placeholder")))}function f(e){e=parseFloat(e.replace(/[^-0123456789.]/g,""));return e=isNaN(e)?0:e}h(!0),u(".phone-mask").mask("(999) 999-9999",{showMaskOnFocus:!0,showMaskOnHover:!1,autoUnmask:!0,clearMaskOnLostFocus:!0}),u(".leadForm__range").each(function(e){var l=u(this),d=l.attr("data-min"),t=l.attr("data-max"),a=f(l.attr("value")),r=l.attr("data-symbol"),n=(l.parents(".leadForm__group").hasClass("leadForm__group-percentage")?1:0)?.01:1,p=l.val();l.inputSliderRange({min:parseInt(d),max:parseInt(t),start:parseInt(a),step:n,grid:1,gridCompression:1,gridSuffix:r,gridCompressionValues:{"-9999999":{text:"",compression:0,digits:0},1e3:{text:"K+",compression:3,digits:0},1e6:{text:"M+",value:3,compression:0,digits:1},1e9:{text:"B+",compression:9,digits:1}},onChanged:function(e){var t,a,r,n,s,o,i;e.hasOwnProperty("detail")&&(o=e.detail.current,t=parseInt(l.attr("data-max")),a=o<1?o:_(o),r=l.parents(".leadForm__group").find(".money"),n=f(r.val()),(s=l.parents(".leadForm__group").hasClass("leadForm__group-percentage"))&&(e=f(l.parents(".leadForm__step").prev().find(".money").val()),o=parseFloat(e/100*o).toFixed(0),l.parents(".leadForm__group").find(".onlyNumbers").attr("data-max",e),l.parents(".leadForm__group").find(".onlyNumbers").attr("data-validate","number")),s?(l.parents(".leadForm__group").find(".rangeTarget:not(.money)").val(g(a)),i=setInterval(function(){o<n&&o>=parseFloat(r.attr("data-max"))?r.val(_(n)):r.val(_(o)),clearInterval(i)},50)):o<=t||d<=o?l.parents(".leadForm__group").find(".money").val(_(o)):l.parents(".leadForm__group").find(".money").val(_(p)))}}),l.inputSliderRange("setTo",a)}),u(document.body).on("click",".stepDots__item",function(e){var t=u(this);u(".leadForm__step-active .leadForm__input-error").length;(t.hasClass("stepDots__item-active")||t.hasClass("stepDots__item-done"))&&(v(t.attr("data-step")),t.addClass("stepDots__item-active"))}),n.trigger("reset"),u(document).on("geolocation_received",function(e,t){void 0!==(t=t)&&t.hasOwnProperty("zip_code")&&(u(document).off("geolocation_received"),a=t.zip_code,h(!1),r.val(a).trigger("change"),r.removeClass("leadForm__input-error").addClass("leadForm__input-success"),function(e){n.append('<input type="hidden" readonly="true" name="city" value="'+e.city+'">'),n.append('<input type="hidden" readonly="true" name="county" value="'+e.county_name+'">'),n.append('<input type="hidden" readonly="true" name="state" value="'+e.state+'">'),n.append('<input type="hidden" readonly="true" name="country" value="'+e.country+'">')}(t))}),0==sm_user_geo_loading&&h(!0),sm_get_user_geolocation(),u(document.body).on("click",".stepBtn",function(e){var t=u(this),a=t.attr("data-next-step"),r=u(a),n=u(".leadForm__step-active"),s=t.attr("data-loan-type");n.find(".leadForm__input").trigger("change"),s&&(n.attr("data-next-step",a),u(".stepDots").removeClass("stepDots-active"),u('.stepDots[data-loan-type="'+s+'"]').addClass("stepDots-active"),u(".leadForm__loanCol").removeClass("leadForm__loanCol-active"),t.parents(".leadForm__loanCol").addClass("leadForm__loanCol-active")),0<r.length&&0===n.find(".leadForm__input-error").length&&(n.find(".leadForm__btn").removeClass("leadForm__btn-active"),t.hasClass("leadForm__btn")&&t.toggleClass("leadForm__btn-active"),r.find(".leadForm__input:not([type=tel])").prop("required",!0),setTimeout(function(){v(a,"next",!0)},500))}),u(document.body).on("click",".leadForm__navBtn",function(e){e.preventDefault();var t=u(this),a=u(".leadForm__step-active"),r=a.find(".leadForm__input-error").length,e=a.attr("data-prev-step"),t=t.attr("data-slide");(e="next"===t&&a.next().hasClass("leadForm__step-done")?a.attr("data-next-step"):e)&&0===r&&v(e,t)}),u(".percentageVal").bind("change keyup input click",function(t){var e=this.value;this.value=g(this.value),e.match(/^\d+(\.?)\d*$/g)||[8,9,27,35,36,37,38,39,46,110,188].some(function(e){return e===t.keyCode})||(this.value=e.slice(0,-1))}),u(".onlyNumbers").bind("change keyup input click",function(e){this.value.match(/[^0-9+]/g)&&(this.value=this.value.replace(/[^0-9+]/g,""))}),u(document).on("keypress",".checkZip",function(e){u(this).attr("data-user-change",!0)}),u(document).on("input change focusout blur",".validateInput",function(e){u(this);u(".leadForm__step-active").find(".leadForm__errorText").remove(),u(".leadForm__step-active").find(".validateInput").removeClass("leadForm__input-error leadForm__input-success")}),u(document).on("input change click","input[name=loan_type]",function(e){var t=u(this);u('input[name="loan_type"]').prop("checked",!1),t.prop("checked",!0)}),u(document).on("input change click","[data-loan-type]",function(e){var t=u(this).attr("data-loan-type");u('input[value="'+t+'"]').prop("checked",!0)}),n.on("submit",function(e){e.preventDefault(),n.addClass("submit");e=u(this).serializeArray();u.post(sm_obj.ajaxurl,{action:"sm_create_new_lead",data:e},function(e){e.hasOwnProperty("success")&&1==e.success?(n.html(e.success_tpl),(e=u(".interested-articles")).slick({slidesToShow:3,slidesToScroll:1,dots:!1,arrows:!0,prevArrow:'<button type="button" class="slick-prev"></button>',nextArrow:'<button type="button" class="slick-next"></button>',responsive:[{breakpoint:768,settings:{slidesToShow:1,centerMode:!1,slidesToScroll:1,arrows:!0,dots:!1}}]}),e.on("afterChange",function(e,t,a,r){d(".latest_post_item")}),d(".latest_post_item")):alert("Error submit form! Please contact administrator."),n.removeClass("submit")})}),n.find(".leadForm__input-percentage").on("blur change input keyup",function(e){var t=u(this),a=parseFloat(t.attr("min")),r=parseFloat(t.attr("max")),n=f(t.parents(".leadForm__group").find(".money").val()),s=t.parents(".leadForm__group").find(".InputSliderRange-Input");(a&&this.value<a||isNaN(this.value)||!this.value)&&(this.value=a),r&&this.value>r&&(this.value=r);r=f(t.parents(".leadForm__step").prev().find(".money").val()),r=parseFloat(r/100*this.value).toFixed(0);s.inputSliderRange("setTo",this.value),r<n?t.parents(".leadForm__group").find(".money").val(_(n)):t.parents(".leadForm__group").find(".money").val(_(r))}),n.find("input.percentageVal, input.checkZip").on("change focus blur input keyup",function(e){var t=u(this);"focus"===e.type&&t.select()}),n.find("input.money").on("change focus blur input keyup",function(e){var t,a=u(this),r=(f(e.target.value),a.parents(".leadForm__group").find(".InputSliderRange-Input")),n=a.attr("data-validate"),s=parseFloat(a.attr("data-min")),o=parseFloat(a.attr("data-max-range")),i=parseFloat(a.attr("data-max"));if(!("keyup"===e.type&&0<=u.inArray(e.keyCode,[37,39]))){if("blur"===e.type&&(t=f(e.target.value),e.target.value=isNaN(t)?0:t),e.target.classList.contains("money")&&("focus"===e.type?e.target.value=f(e.target.value):"blur"===e.type&&(e.target.value=_(e.target.value))),"change"===e.type||"keyup"===e.type){isNaN(e.target.value)||(e.target.value=f(e.target.value)),n&&"number"===n&&(clearTimeout(m),m=setTimeout(function(){(isNaN(e.target.value)?f:parseFloat)(e.target.value)},1e3));var l,d=parseFloat(e.target.value),p=a.parents(".leadForm__group").hasClass("leadForm__group-percentage");if(p){n=f(a.parents(".leadForm__step").prev().find(".money").val());if(parseFloat(e.target.value)>n&&(e.target.value=d),d/100/100<.01&&0!=d)return;100<(d=g(parseFloat(100*d/n).toFixed(2)))&&(d=i)}c=e.target,"change"==e.type&&(clearInterval(l),l=setInterval(function(){d<s?r.inputSliderRange("setTo",0):o<d?r.inputSliderRange("setTo",o):r.inputSliderRange("setTo",d),e.target.value=p?c.value:_(d),clearInterval(l)},0)),isNaN(e.target.value)||(e.target.value=_(e.target.value))}"focus"===e.type&&a.select()}}),n.bind("keypress keyup keypress keydown",function(e){if(13===e.keyCode||13===e.which)return e.preventDefault(),!1});var e=u("#reviewsSlider");e.slick({slidesToShow:1,slidesToScroll:1,dots:!1,arrows:!0,prevArrow:'<button type="button" class="slick-prev"></button>',nextArrow:'<button type="button" class="slick-next"></button>',responsive:[{breakpoint:768,settings:{slidesToShow:1,centerMode:!1,slidesToScroll:1,arrows:!1,dots:!1}}]}),e.on("afterChange",function(e,t,a,r){d(".reviews__text")}),d(".reviews__text")});
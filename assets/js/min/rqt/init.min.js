"use strict";function _defineProperty(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var form_submited=0,cities=null,default_cities_list="",$calc_wrapper=$("#calc-content");function getRates(){$("#parametersForm").hasClass("cached")?form_submited+=1:(form_submited+=1,$("#parametersForm").submit()),null!=cities&&set_cities({cities:cities})}function animate_rates_scroll(){var t=$("body").hasClass("logged-in")?32:0;(window.innerWidth<=991||820<=window.innerWidth&&window.innerWidth<=1200&&"undefined"!=typeof data&&"true"==data.get("submit_form"))&&$("html, body").animate({scrollTop:$(".rates-wrapper").offset().top-$("header").outerHeight()-$("#chkbox-options").outerHeight()-t},700)}function saveRQTForm_ls(){var e=[];$("#parameters input[type=text], #parameters select, #chkbox-options input").each(function(){var t="";"checkbox"==$(this).attr("type")?(t=1==$(this).prop("checked"),$(this).parents(".extra-options").hasClass("hidden")||e.push({name:$(this).attr("name"),type:"checkbox",value:t})):(t=$(this).val(),e.push({name:$(this).attr("name"),disabled:!!$(this).is("[disabled]"),type:"field",value:t}))}),e.push({name:"url",type:"url",value:window.location.href}),e.push({name:"rates",type:"html",container:"#rates-wrapper",value:$("#rates-wrapper").html()}),e.push({name:"loc_header",type:"html",container:".city-zip-header",value:$(".city-zip-header").html()}),localStorage.setItem("rqtForm",JSON.stringify(e))}function getRQTForm_ls(){var t,e;1==getCookie("js_session")&&($calc_wrapper.addClass("preload-values"),void 0!==(t=localStorage.getItem("rqtForm"))&&null!=t&&""!=t&&(t=JSON.parse(t),$.each(t,function(t,e){"field"==e.type&&($('[name="'+e.name+'"]').val(e.value),null!=e.disabled&&1==e.disabled?$('[name="'+e.name+'"]').prop("disabled",!0):$('[name="'+e.name+'"]').prop("disabled",!1)),"html"==e.type&&$(e.container).html(e.value),"checkbox"==e.type&&($('[name="'+e.name+'"]').prop("checked",e.value),$('[name="'+e.name+'"]').parents(".extra-options").removeClass("hidden"))}),$(".field.down_payment input").is("[disabled]")&&$(".field.down_payment .fld-input").addClass("not-preload"),e=setInterval(function(){$calc_wrapper.removeClass("preload-values"),clearInterval(e)},100))),update_view()}function jsRatesDefault(){localStorage.removeItem("rqtForm"),delCookie("mortgage_l_r"),delCookie("js_session"),getRQTForm_ls()}function init_range_slider(t){var e=parseFloat(t.attr("data-min")),a=parseFloat(t.attr("data-max")),i=(parseFloat(t.attr("data-step")),parseFloat(t.attr("data-value"))),o=t;o.slider({range:"min",min:e,max:a,value:i,slide:function(t,e){$(this).parents("label").find("[data-slider-target]").val(e.value).trigger("keyup").trigger("change"),$(this).find(".ui-slider-handle").text("")},create:function(t,e){o.find(".ui-slider-handle").text("").attr("tabindex","-1")}})}function init_range_sliders(){991<window.innerWidth&&$(".value-slider").each(function(){var t=parseFloat($(this).attr("data-min")),e=parseFloat($(this).attr("data-max")),a=(parseFloat($(this).attr("data-step")),parseFloat($(this).attr("data-value"))),i=$(this);$(this).slider({range:"min",min:t,max:e,value:a,slide:function(t,e){$(this).parents("label").find("[data-slider-target]").val(e.value).trigger("keyup").trigger("change"),$(this).find(".ui-slider-handle").text("")},create:function(t,e){var a=setInterval(function(){i.find(".ui-slider-handle").text("").attr("tabindex","-1"),clearInterval(a)},20)}})})}function getJSRates(){var a,t=localStorage.getItem("rqtForm"),e=(window.location.pathname,window.location.href);window.location.origin;null!=t&&void 0!==t&&""!=t&&(t=JSON.parse(t),a="",$.each(t,function(t,e){"url"==e.name&&(a=e.value)})),e!=a&&jsRatesDefault(),1!=getCookie("js_session")||e!=a?($calc_wrapper.addClass("preload-values"),$.get("https://ipinfo.io",function(t){get_location(t.country)},"json")):getRQTForm_ls()}function get_location(t){var e=window.location.href,a={};if("US"!=t)a=geolocation_vars.geoLocation,createCookieHours("js_session",1,1),createCookieHours("geolocation",JSON.stringify(a),1),sm_user_geo_loading=!1,$calc_wrapper.removeClass("preload-values");else{if(a=getCookie("geolocation"))try{if(!(a=JSON.parse(a)).hasOwnProperty("country")||!a.hasOwnProperty("zip_code")||!a.hasOwnProperty("state"))throw"geolocation error"}catch(t){a=!1}a&&0!=a?(a=geolocation_vars.geoLocation,createCookieHours("js_session",1,1),createCookieHours("geolocation",JSON.stringify(a),1),sm_user_geo_loading=!1,$calc_wrapper.removeClass("preload-values")):jQuery.post("https://www.googleapis.com/geolocation/v1/geolocate?key="+geolocation_vars.geoApiKey+"&v=3").done(function(t){var a=new XMLHttpRequest;a.open("GET",rqt_vars._rqt_router+"?action=custom_action&referrer=wp&value=getLocation&url="+e+"&location="+JSON.stringify(t)+"&rqt_message="+rqt_vars._rqt_message+"&rqt_config="+$.base64.encode(rqt_vars._rqt_default_form)),a.responseType="json",a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.send(),a.onload=function(){var t=a.response,e={country:t.geolocation.country,zip_code:t.geolocation.zip_code,state_code:t.geolocation.statecode,state:t.geolocation.state,city:t.geolocation.city,county_name:t.geolocation.county_name};form_submited+=1,$calc_wrapper.html($.base64.decode(t.view)),createCookieHours("js_session",1,1),createCookieHours("geolocation",JSON.stringify(e),1),$calc_wrapper.removeClass("preload-values"),sm_user_geo_loading=!1,after_submit(null,t)}})}}function set_cities(t){default_cities_list||void 0===t?($(".modal-popover .data-list").empty(),$(".modal-popover .data-list").html(default_cities_list)):(t=(t=(cities=t.cities).list).slice(0,15),$(".modal-popover .data-list").empty(),$.each(t,function(t,e){var a=void 0!==e.zip_childs&&1==e.zip_childs?"true":"false",e='<li data-type="city"  data-county="'+e.county+'" data-state="'+e.state+'"  data-childs="'+a+'" data-city="'+e.city+'" data-zip="'+e.zip+'"><a href="#">'+e.city+'<span class="advanced-title"><span class="item-state">'+e.state+'</span> <span class="item-county">('+e.county+")</span></span></a></li>";$(".modal-popover .data-list").append(e),default_cities_list+=e}),null!=(t=localStorage.getItem("qrt_cities"))&&void 0!==t&&""!=t||(localStorage.setItem("qrt_cities",JSON.stringify(cities)),createCookie("cities_loaded",1,180))),afterCitiesInsert()}function afterCitiesInsert(){cities.list.slice(0,15);var s=$(".modal-popover .data-list");$(".modal-popover .filter-input").bind("keyup paste",function(){var o=$(this).val();s.html("");var n=0;o.split(" ").filter(function(t){return""!==t});if(""!=o)if($.isNumeric(o)){var n=0,t=void 0!==s.attr("data-selected-city")?cities.zip[s.attr("data-selected-city")].list:cities.zip_index;s.empty(),$.map(t,function(t,e){var a;void 0!==s.attr("data-selected-city")?0<=t.indexOf(o)&&(15<n||(a='<li data-type="zip"  data-county="'+cities.zip[s.attr("data-selected-city")].info.county+'" data-state="'+cities.zip[s.attr("data-selected-city")].info.state+'" data-city="'+cities.zip[s.attr("data-selected-city")].info.city+'" data-zip="'+t+'"><a href="#">'+t+"</a></li>",s.append(a),n+=1)):0<=e.indexOf(o)&&(15<n||(t='<li data-type="zip"  data-county="'+t.county+'" data-state="'+t.state+'" data-city="'+t.city+'" data-zip="'+e+'"><a href="#">'+e+'<span class="advanced-title"><span class="item-state">'+t.state+'</span> <span class="item-county">('+t.county+")</span></span></a></li>",s.append(t),n+=1))})}else{if(void 0!==s.attr("data-selected-city"))return void s.empty();cities.list.map(function(t,e){var a,i;o==t.city?(s.empty(),(a=cities.zip[o]).list.map(function(t,e){t='<li data-type="zip"  data-county="'+a.info.county+'" data-state="'+a.info.state+'" data-city="'+o+'" data-zip="'+t+'"><a href="#">'+t+"</a></li>";s.append(t)})):(0<=t.city.toLowerCase().indexOf(o)||0<=t.city.indexOf(o))&&(15<n||(i=void 0!==t.zip_childs&&1==t.zip_childs?"true":"false",t='<li data-type="city"  data-county="'+t.county+'" data-state="'+t.state+'"  data-type="city"  data-county="'+t.county+'" data-state="'+t.state+'" data-childs="'+i+'" data-city="'+t.city+'" data-zip="'+t.zip+'"><a href="#">'+t.city+'<span class="advanced-title"><span class="item-state">'+t.state+'</span> <span class="item-county">('+t.county+")</span></span></a></li>",s.append(t),n+=1))})}else void 0!==s.attr("data-selected-city")?$(".modal-popover .data-list").html(rqt_get_ziplist_by_city(rqt_vars._rqt_city)):$(".modal-popover .data-list").html(default_cities_list);init_ZIPmodal_popup()})}function rqt_get_ziplist_by_city(a){$.map(cities.zip[a].list,function(t,e){t='<li data-type="zip"  data-county="'+cities.zip[a].info.county+'" data-state="'+cities.zip[a].info.state+'" data-city="'+a+'" data-zip="'+t+'"><a href="#">'+t+"</a></li>";$(".modal-popover .data-list").append(t)})}function init_selectbox(){820<window.innerWidth&&$("form#parametersForm select:not(.no-js-styling)").select2({minimumResultsForSearch:-1})}function init_form_formatting(){$("input.currency").trigger("keyup")}function init_form_validation(){jQuery(".form-validate").validate(_defineProperty({errorElement:"div",onfocusout:!1,onkeyup:!1,onclick:!1,onsubmit:!0,errorPlacement:function(t,e){t.appendTo(e.parents("label")),0<e.parents(".fields-group").length&&e.parents(".fields-group").addClass("group-error")}},"onkeyup",function(t){$(t).parents(".fields-group").removeClass("group-error"),$(t).valid()}))}function after_submit(t,e){init_range_sliders(),init_selectbox(),set_cities(e),saveRQTForm_ls(),update_view(),init_form_validation(),init_form_formatting(),animate_rates_scroll(),$calc_wrapper.find("#rates-wrapper").removeClass("loading"),$calc_wrapper.removeClass("loading")}$(window).on("resize",function(){init_range_sliders()}),$(window).on("orientationchange",function(){init_range_sliders()},!1),$(document).ready(function(){init_range_sliders(),getJSRates(),init_selectbox(),update_view(),init_form_validation(),init_form_formatting();var t=localStorage.getItem("qrt_cities");return cities=null==t||void 0===t||""==t?(localStorage.setItem("qrt_cities",citiesJSON),JSON.parse(citiesJSON)):JSON.parse(t),$(document).on("submit","#parametersForm",function(t){t.preventDefault();var e=new FormData($(this)[0]),a=rqt_vars._rqt_router;$calc_wrapper.find("#rates-wrapper").addClass("loading"),$calc_wrapper.addClass("loading"),0<form_submited&&e.append("submit_form",!0),cities&&e.append("cities_loaded",!0),void 0!==rqt_vars._rqt_default_form&&null!=rqt_vars._rqt_default_form&&e.append("rqt_config",JSON.stringify(rqt_vars._rqt_default_form)),e.append("referrer","wp"),e.append("cached",!1);t=new URLSearchParams(e);before_submit(e,t),fetch(a,{method:"post",headers:{"Content-Encoding":"gzip","X-Requested-With":"XMLHttpRequest","Accept-Encoding":"gzip"},body:t}).then(function(t){saveRQTForm_ls(),t.json().then(function(t){form_submited+=1,$calc_wrapper.html($.base64.decode(t.view)),after_submit(e,t),$(document.body).trigger("updated_rates",[t])})}).finally(function(t){}).catch(function(t){return console.error("error:",t)})}),getRates()}),$.validator.methods.min=function(t,e,a){t=cleanNum_validate(t);return this.optional(e)||a<=t},$.validator.methods.max=function(t,e,a){t=cleanNum_validate(t);return this.optional(e)||t<=a},$.validator.methods.range=function(t,e,a){t=cleanNum_validate(t);return this.optional(e)||t>=a[0]&&t<=a},$.validator.methods.equalTo=function(t,e,a){t=cleanNum_validate(t);return this.optional(e)||t===a},jQuery.validator.defaults.onkeyup=function(t,e){9===e.which&&""===this.elementValue(t)||(t.name in this.submitted||t===this.lastElement)&&this.element(t)},jQuery.validator.defaults.onfocusout=function(t,e){this.checkable(t)||!(t.name in this.submitted)&&this.optional(t)||this.element(t)};